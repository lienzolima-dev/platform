import"./Dialog.astro_astro_type_script_index_0_lang.C-5Vl6lh.js";import{u as l}from"./filter.Dk79kzbe.js";import{a,i as m}from"./_astro_actions.B-cTUEzu.js";import{c as f,o as i}from"./utils.oMC_d_GW.js";import"./CloseMenuButton.astro_astro_type_script_index_0_lang.nee8CeAz.js";const d=document.getElementById("search-user-btn"),c=document.getElementById("search-input");try{if(!(d instanceof HTMLButtonElement))throw new Error("Search user button not found");if(!(c instanceof HTMLInputElement))throw new Error("Search input not found");const e=()=>{const t=new URL(window.location.href),n=l(t,{search:c.value.trim(),page:"1"});window.location.href=n};d.addEventListener("click",e),c.addEventListener("keydown",t=>{t.key==="Enter"&&e()})}catch(e){console.error("Error: ",e)}try{const e=document.getElementById("edit-user-form"),t=document.getElementById("u-edit-error-content"),n=document.getElementById("u-edit-submit-btn");if(!(e instanceof HTMLFormElement))throw new Error("Form not found");if(!t)throw new Error("Error content not found");if(!(n instanceof HTMLButtonElement))throw new Error("Submit button not found");e.addEventListener("submit",async o=>{o.preventDefault();const s=new FormData(e);n.disabled=!0;const{error:r}=await a.db.users.editUser(s);if(n.disabled=!1,r||location.reload(),r){if(m(r)){t.innerText=r.issues[0].message;return}t.innerText=r.message;return}})}catch(e){console.error(e)}try{const e=document.getElementById("delete-user-form"),t=document.getElementById("u-delete-submit-btn"),n=document.querySelector("button.cancel"),o=document.getElementById("u-delete-error-content");if(!n||!(t instanceof HTMLButtonElement))throw"Button not found";if(!(e instanceof HTMLFormElement))throw"Form not found";if(!o)throw"Error content not found";e.addEventListener("submit",async s=>{s.preventDefault();const r=new FormData(e);t.disabled=!0;const{error:u}=await a.db.users.deleteUser(r);if(t.disabled=!1,!u){location.reload();return}o.innerText=u.message}),n.addEventListener("click",()=>f("deleteUser"))}catch(e){console.error("Error:",e)}class E extends HTMLElement{connectedCallback(){const t=this.querySelector("button"),n=document.getElementById("edit-user-form");if(!t)throw"Button not found";if(!(n instanceof HTMLFormElement))throw new Error("Form not found");const o=JSON.parse(this.dataset.user||"{}");t.addEventListener("click",async()=>{n.userId.value=o.id,n.username.value=o.name,n.email.value=o.email,n.phone.value=o.phone,i("editUser")})}}customElements.define("user-edit-button",E);class h extends HTMLElement{connectedCallback(){const t=this.querySelector("button"),n=document.getElementById("delete-user-form"),o=document.getElementById("u-delete-error-content"),s=document.getElementById("selected-user");if(!t)throw"Button not found";if(!(n instanceof HTMLFormElement))throw"Form not found";if(!s)throw"Selected user element not found";if(!o)throw"Error content not found";t.addEventListener("click",()=>{const{id:r,name:u}=JSON.parse(this.dataset.user||"{}");n.userId.value=r,s.innerHTML=u,o.innerText="",i("deleteUser")})}}customElements.define("user-delete-button",h);
