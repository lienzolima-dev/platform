import"./Dialog.astro_astro_type_script_index_0_lang.C-5Vl6lh.js";import{o as u,c as g}from"./utils.oMC_d_GW.js";import{u as y}from"./filter.Dk79kzbe.js";import{a as m,i as h}from"./_astro_actions.B-cTUEzu.js";import"./CloseMenuButton.astro_astro_type_script_index_0_lang.nee8CeAz.js";const b=document.getElementById("add-collaborator-btn"),w=document.getElementById("search-collaborator-btn"),i=document.getElementById("search-input");try{if(!b)throw new Error("Add collaborator button not found");if(!(w instanceof HTMLButtonElement))throw new Error("Search collaborator button not found");if(!(i instanceof HTMLInputElement))throw new Error("Search input not found");b.addEventListener("click",()=>{u("addCollaborator")});const o=()=>{const t=new URL(window.location.href),e=y(t,{search:i.value.trim(),page:"1"});window.location.href=e};w.addEventListener("click",o),i.addEventListener("keydown",t=>{t.key==="Enter"&&o()})}catch(o){console.error("Error: ",o)}try{const o=document.getElementById("edit-collaborator-form"),t=document.getElementById("c-edit-error-content"),e=document.getElementById("c-toggle-password"),n=document.getElementById("c-password-fields"),a=document.getElementById("c-password"),l=document.getElementById("c-confirm-password"),r=document.getElementById("c-edit-submit-btn");if(!(a instanceof HTMLInputElement))throw new Error("Password input not found");if(!(l instanceof HTMLInputElement))throw new Error("Confirm password input not found");if(!(o instanceof HTMLFormElement))throw new Error("Form not found");if(!(r instanceof HTMLButtonElement))throw new Error("Submit button not found");e instanceof HTMLInputElement&&n&&e.addEventListener("change",()=>{n.classList.toggle("hidden"),e.checked?(a.required=!0,l.required=!0):(a.required=!1,a.value="",l.required=!1,l.value="")}),o.addEventListener("submit",async s=>{s.preventDefault();const d=new FormData(o);r.disabled=!0;const{error:c}=await m.db.users.editCollaborator(d);if(r.disabled=!1,c||location.reload(),c&&t instanceof HTMLElement){if(t.innerHTML="",h(c)){const f=document.createElement("ul");c.issues.forEach(p=>{const E=document.createElement("li");E.innerText=p.message,f.appendChild(E)}),t.appendChild(f);return}t.innerText=c.message}})}catch(o){console.error("Error:",o)}try{const o=document.getElementById("delete-collaborator-form"),t=document.getElementById("c-delete-submit-btn"),e=document.querySelector("button.cancel"),n=document.getElementById("c-delete-error-content");if(!e||!(t instanceof HTMLButtonElement))throw"Button not found";if(!(o instanceof HTMLFormElement))throw"Form not found";if(!n)throw"Error content not found";o.addEventListener("submit",async a=>{a.preventDefault();const l=new FormData(o);t.disabled=!0;const{error:r}=await m.db.users.deleteCollaborator(l);if(t.disabled=!1,!r){location.reload();return}n.innerText=r.message}),e.addEventListener("click",()=>g("deleteCollaborator"))}catch(o){console.error("Error:",o)}class B extends HTMLElement{connectedCallback(){const t=this.querySelector("form"),e=this.querySelector(".error-content"),n=this.querySelector(".submit-button");if(!t)throw new Error("Form not found");if(!e)throw new Error("Error content not found");if(!(n instanceof HTMLButtonElement))throw new Error("Submit button not found");t.addEventListener("submit",async a=>{a.preventDefault();const l=new FormData(t);n.disabled=!0;const{error:r}=await m.db.users.addCollaborator(l);if(n.disabled=!1,!r){location.reload();return}if(r&&e instanceof HTMLElement){if(e.innerHTML="",h(r)){const s=document.createElement("ul");r.issues.forEach(d=>{const c=document.createElement("li");c.innerText=d.message,s.appendChild(c)}),e.appendChild(s);return}e.innerText=r.message}})}}customElements.define("collaborator-add-form",B);class L extends HTMLElement{connectedCallback(){const t=this.querySelector("button"),e=document.getElementById("edit-collaborator-form");if(!t)throw"Button not found";if(!(e instanceof HTMLFormElement))throw new Error("Form not found");const n=JSON.parse(this.dataset.collaborator||"{}");t.addEventListener("click",async()=>{e.userId.value=n.id,e.username.value=n.name,e.email.value=n.email,e.phone.value=n.phone,e.userRole.value=n.role,u("editCollaborator")})}}customElements.define("user-collaborator-button",L);class I extends HTMLElement{connectedCallback(){const t=this.querySelector("button"),e=document.getElementById("delete-collaborator-form"),n=document.getElementById("c-delete-error-content"),a=document.getElementById("selected-collaborator");if(!t)throw"Button not found";if(!(e instanceof HTMLFormElement))throw"Form not found";if(!a)throw"Selected collaborator element not found";if(!n)throw"Error content not found";t.addEventListener("click",()=>{const{id:l,name:r}=JSON.parse(this.dataset.collaborator||"{}");e.collaboratorId.value=l,a.innerHTML=r,n.innerText="",u("deleteCollaborator")})}}customElements.define("collaborator-delete-button",I);
