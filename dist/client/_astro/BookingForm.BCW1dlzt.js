import{l as ge,p as y,i as ee,e as te,b as he,a as ae,c as f,r as M,d as pe,D as _e,f as be}from"./es.CElM7CcV.js";import{i as ye,r as qe,h as we,f as j,j as q,k as T,l as n,n as l,s as d,o as A,p as i,q as Te,v as Y,w as Z,x as ne,y as Se,z as Pe,A as oe,B as w,C as h,D as xe}from"./render.UUuJgdNI.js";/* empty css                             *//* empty css                          */import{a as de,i as De}from"./_astro_actions.B-cTUEzu.js";import{o as ke}from"./utils.oMC_d_GW.js";function U(a,e,r=e){var o=ye();ge(a,"input",()=>{var s=ie(a)?se(a.value):a.value;r(s),o&&s!==(s=e())&&(a.value=s??"")}),qe(()=>{var s=e();if(we&&a.defaultValue!==a.value){r(a.value);return}ie(a)&&s===se(a.value)||a.type==="date"&&!s&&!a.value||s!==a.value&&(a.value=s??"")})}function ie(a){var e=a.type;return e==="number"||e==="range"}function se(a){return a===""?null:+a}var Oe=T("<option disabled selected> </option>"),ze=T("<option disabled selected>Selecciona una opción</option>"),Ce=T("<option> </option>"),Ee=T('<select name="manicuristId" id="manicurist" class="svelte-1o8osfi"><!><!></select>');function $(a,e){let r=y(e,"value",15);var o=Ee(),s=n(o);ee(s,()=>e.noOptionText,c=>{var u=Oe();u.value=((u.__value="")==null,"");var g=n(u,!0);l(u),j(()=>A(g,e.noOptionText)),q(c,u)},c=>{var u=ze();u.value=((u.__value="")==null,""),q(c,u)});var v=d(s);te(v,17,()=>e.options,ae,(c,u)=>{var g=Ce(),m={},p=n(g,!0);l(g),j(()=>{m!==(m=i(u).value)&&(g.value=(g.__value=i(u).value)==null?"":i(u).value),A(p,i(u).label)}),q(c,g)}),l(o),j(()=>o.required=e.required),he(o,r),q(a,o)}function je(a,e){a.preventDefault(),e([...e(),""])}var He=T('<div class="select svelte-1o5fzkl"><!> <button class="svelte-1o5fzkl">-</button></div>'),Ie=T('<div class="select-stack-container svelte-1o5fzkl"><div class="select-stack svelte-1o5fzkl"></div> <button class="svelte-1o5fzkl">+</button></div>');function le(a,e){Y(e,!0);let r=y(e,"values",31,()=>f([""]));function o(u){if(r().length===1){r([""]);return}r(r().filter((g,m)=>m!==u))}var s=Ie(),v=n(s);te(v,21,r,ae,(u,g,m)=>{var p=He(),_=n(p);$(_,{get options(){return e.options},get noOptionText(){return e.noOptionText},get required(){return e.required},get value(){return r()[m]},set value(D){r(r()[m]=D,!0)}});var b=d(_,2);b.__click=D=>{D.preventDefault(),o(m)},l(p),q(u,p)}),l(v);var c=d(v,2);c.__click=[je,r],l(s),q(a,s),Z()}Te(["click"]);var Fe=T('<section class="svelte-1jzdq81"><h2 class="svelte-1jzdq81">Datos de la reserva:</h2> <div class="booking-data svelte-1jzdq81"><div class="input-container svelte-1jzdq81"><label for="service">Servicio:</label> <!></div> <div class="input-container svelte-1jzdq81"><label for="extra">Adicional:</label> <!></div> <div class="input-container svelte-1jzdq81"><label for="manicurist">Manicurista:</label> <!></div> <div class="input-container svelte-1jzdq81"><label for="paying-state">Estado del Pago:</label> <div class="flex svelte-1jzdq81"><!> <input type="number" placeholder="Ingrese el monto" class="svelte-1jzdq81"></div></div> <div class="input-container svelte-1jzdq81"><label for="price">Precio Total:</label> <input type="number" id="price" name="price" placeholder="Ingrese el precio total" required class="svelte-1jzdq81"></div></div></section>');function Re(a,e){let r=y(e,"selectedManicurist",15,""),o=y(e,"selectedPayingState",15,""),s=y(e,"selectedServices",31,()=>f([""])),v=y(e,"selectedExtras",31,()=>f([""])),c=y(e,"totalPrice",15,null),u=y(e,"advanceAmount",15,null),g=[{value:"full",label:"Pago Completo"},{value:"advance",label:"Adelanto"},{value:"partial",label:"Pago Parcial"},{value:"none",label:"No Pago"}];function m(){return o()==="partial"||o()==="advance"}var p=Fe(),_=d(n(p),2),b=n(_),D=d(n(b),2);le(D,{get options(){return e.servicesOptions},noOptionText:"Seleccion un servicio",get values(){return s()},set values(k){s(k)},required:!0}),l(b);var S=d(b,2),C=d(n(S),2);le(C,{get options(){return e.extrasOptions},noOptionText:"Selecciona un adicional",get values(){return v()},set values(k){v(k)}}),l(S);var P=d(S,2),L=d(n(P),2);$(L,{get options(){return e.manicuristsOptions},noOptionText:"Selecciona un manicurista",get value(){return r()},set value(k){r(k)},required:!0}),l(P);var H=d(P,2),I=d(n(H),2),E=n(I);$(E,{options:g,noOptionText:"Selecciona un estado",get value(){return o()},set value(k){o(k)},required:!0});var O=d(E,2);M(O),j(()=>O.required=m()),j(()=>O.disabled=!m()),l(I),l(H);var F=d(H,2),R=d(n(F),2);M(R),l(F),l(_),l(p),U(O,u),U(R,c),q(a,p)}let Q=new Map;class Ae{format(e){return this.formatter.format(e)}formatToParts(e){return this.formatter.formatToParts(e)}formatRange(e,r){if(typeof this.formatter.formatRange=="function")return this.formatter.formatRange(e,r);if(r<e)throw new RangeError("End date must be >= start date");return`${this.formatter.format(e)} – ${this.formatter.format(r)}`}formatRangeToParts(e,r){if(typeof this.formatter.formatRangeToParts=="function")return this.formatter.formatRangeToParts(e,r);if(r<e)throw new RangeError("End date must be >= start date");let o=this.formatter.formatToParts(e),s=this.formatter.formatToParts(r);return[...o.map(v=>({...v,source:"startRange"})),{type:"literal",value:" – ",source:"shared"},...s.map(v=>({...v,source:"endRange"}))]}resolvedOptions(){let e=this.formatter.resolvedOptions();return Ue()&&(this.resolvedHourCycle||(this.resolvedHourCycle=Le(e.locale,this.options)),e.hourCycle=this.resolvedHourCycle,e.hour12=this.resolvedHourCycle==="h11"||this.resolvedHourCycle==="h12"),e.calendar==="ethiopic-amete-alem"&&(e.calendar="ethioaa"),e}constructor(e,r={}){this.formatter=ve(e,r),this.options=r}}const Be={true:{ja:"h11"},false:{}};function ve(a,e={}){if(typeof e.hour12=="boolean"&&Me()){e={...e};let s=Be[String(e.hour12)][a.split("-")[0]],v=e.hour12?"h12":"h23";e.hourCycle=s??v,delete e.hour12}let r=a+(e?Object.entries(e).sort((s,v)=>s[0]<v[0]?-1:1).join():"");if(Q.has(r))return Q.get(r);let o=new Intl.DateTimeFormat(a,e);return Q.set(r,o),o}let W=null;function Me(){return W==null&&(W=new Intl.DateTimeFormat("en-US",{hour:"numeric",hour12:!1}).format(new Date(2020,2,3,0))==="24"),W}let X=null;function Ue(){return X==null&&(X=new Intl.DateTimeFormat("fr",{hour:"numeric",hour12:!1}).resolvedOptions().hourCycle==="h12"),X}function Le(a,e){if(!e.timeStyle&&!e.hour)return;a=a.replace(/(-u-)?-nu-[a-zA-Z0-9]+/,""),a+=(a.includes("-u-")?"":"-u")+"-nu-latn";let r=ve(a,{...e,timeZone:void 0}),o=parseInt(r.formatToParts(new Date(2020,2,3,0)).find(v=>v.type==="hour").value,10),s=parseInt(r.formatToParts(new Date(2020,2,3,23)).find(v=>v.type==="hour").value,10);if(o===0&&s===23)return"h23";if(o===24&&s===23)return"h24";if(o===0&&s===11)return"h11";if(o===12&&s===11)return"h12";throw new Error("Unexpected hour cycle result")}var Ne=T('<div class="date-picker svelte-psy4bv"><!></div>');function Ye(a,e){Y(e,!0);let r=y(e,"date",15);r(new Date);let o=new Date;o.setFullYear(o.getFullYear()+1);let s=pe(be);var v=Ne(),c=n(v);_e(c,{get value(){return r()},set value(u){r(u)},max:o,locale:s}),l(v),q(a,v),Z()}var Ze=T('<div class="table-row svelte-1qgdws0"><div class="svelte-1qgdws0"> </div> <div class="svelte-1qgdws0"> </div> <div class="svelte-1qgdws0"> </div> <div class="svelte-1qgdws0"> </div></div>'),Ke=T('<div class="void-table-row svelte-1qgdws0">No hay horarios usados</div>'),Ve=T('<section class="svelte-1qgdws0"><h2 class="svelte-1qgdws0">Fecha y Hora:</h2> <div class="current-times-container svelte-1qgdws0"><div class="date-picker"><label for="date">Selecciona un día:</label> <!></div> <div class="current-bookings svelte-1qgdws0"><h3 class="svelte-1qgdws0">Horarios usados el <em> </em>:</h3> <div class="current-bookings-list svelte-1qgdws0"><div class="table-head svelte-1qgdws0"><div class="svelte-1qgdws0">Horario Usado</div> <div class="svelte-1qgdws0">Manicurista</div> <div class="svelte-1qgdws0">Cliente</div> <div class="svelte-1qgdws0">Estado</div></div> <div class="table-body svelte-1qgdws0"><!></div></div></div></div> <div class="time-inputs svelte-1qgdws0"><div class="input-container svelte-1qgdws0"><label for="start-time">Inicio:</label> <input type="time" id="start-time" name="startTime" step="60" required class="svelte-1qgdws0"></div> <div class="input-container svelte-1qgdws0"><label for="end-time">Final:</label> <input type="time" id="end-time" name="endTime" step="60" required class="svelte-1qgdws0"></div></div></section>');function Ge(a,e){Y(e,!0);const r=new Ae("es-PE",{dateStyle:"long"});let o=y(e,"date",15),s=y(e,"startTime",15),v=y(e,"endTime",15),c=w(null);function u(t){return t.toLocaleTimeString("es-PE",{hour:"2-digit",minute:"2-digit",hour12:!0})}function g(t){if(t==="advance")return"Adelantado";if(t==="full")return"Pago completo";if(t==="partial")return"Pago parcial";if(t==="none")return"Sin pagar"}ne(()=>{const t=o();async function x(){const{data:z}=await de.db.bookings.get({date:t.toISOString()});z&&h(c,f(z.map(B=>({startTime:u(new Date(B.startTime)),endTime:u(new Date(B.endTime)),manicurist:B.manicurist,name:B.name,state:B.paymentStatus}))))}x()});var m=Ve(),p=d(n(m),2),_=n(p),b=d(n(_),2);Ye(b,{get date(){return o()},set date(t){o(t)}}),l(_);var D=d(_,2),S=n(D),C=d(n(S)),P=n(C,!0);j(()=>A(P,r.format(o()))),l(C),oe(),l(S);var L=d(S,2),H=d(n(L),2),I=n(H);ee(I,()=>i(c)&&i(c).length>0,t=>{var x=Se(),z=Pe(x);te(z,17,()=>i(c),ae,(B,N)=>{var K=Ze(),V=n(K),ue=n(V);l(V);var G=d(V,2),ce=n(G,!0);l(G);var J=d(G,2),me=n(J,!0);l(J);var re=d(J,2),fe=n(re,!0);j(()=>A(fe,g(i(N).state))),l(re),l(K),j(()=>{A(ue,`${i(N).startTime??""} - ${i(N).endTime??""}`),A(ce,i(N).manicurist),A(me,i(N).name)}),q(B,K)}),q(t,x)},t=>{var x=Ke();q(t,x)}),l(H),l(L),l(D),l(p);var E=d(p,2),O=n(E),F=d(n(O),2);M(F),l(O);var R=d(O,2),k=d(n(R),2);M(k),l(R),l(E),l(m),U(F,s),U(k,v),q(a,m),Z()}var Je=T('<section class="svelte-19hy4rd"><h2 class="svelte-19hy4rd">Datos del cliente:</h2> <div class="user-data svelte-19hy4rd"><div class="input-container svelte-19hy4rd"><label for="name">Nombre:</label> <input type="text" id="name" name="name" required class="svelte-19hy4rd"></div> <div class="input-container svelte-19hy4rd"><label for="email">Email:</label> <input type="email" id="email" name="email" class="svelte-19hy4rd"></div> <div class="input-container svelte-19hy4rd"><label for="phone">Teléfono:</label> <input type="tel" id="phone" name="phone" class="svelte-19hy4rd"></div></div></section>');function Qe(a,e){let r=y(e,"name",15),o=y(e,"email",15),s=y(e,"phone",15);var v=Je(),c=d(n(v),2),u=n(c),g=d(n(u),2);M(g),l(u);var m=d(u,2),p=d(n(m),2);M(p),l(m);var _=d(m,2),b=d(n(_),2);M(b),l(_),l(c),l(v),U(g,r),U(p,o),U(b,s),q(a,v)}var We=T('<div class="error-content svelte-1p7eyp4"> </div>'),Xe=T('<div class="booking-form-container svelte-1p7eyp4"><form class="svelte-1p7eyp4"><!> <!> <!> <!> <button type="submit" class="svelte-1p7eyp4">Reservar</button></form></div>');function st(a,e){Y(e,!0);const r=e.services.map(t=>({value:t.id,label:t.name})),o=e.extras.map(t=>({value:t.id,label:t.name}));let s=w(""),v=w(null),c=w(null),u=w(""),g=w(""),m=w(f([""])),p=w(f([""])),_=w(null),b=w(null),D=w(f(new Date)),S=w(""),C=w(""),P=w("");function L(){h(S,f(i(S).slice(0,5))),h(C,f(i(C).slice(0,5)))}async function H(t){if(t.preventDefault(),!i(_)){h(P,"Ingrese un precio total");return}if(i(b)||h(b,0),i(g)===""){h(P,"Seleccione un estado de pago");return}L();const x={name:i(s),email:i(v),phone:i(c),manicuristId:i(u),paymentStatus:i(g),services:i(m),extras:i(p),totalPrice:i(_),advanceAmount:i(b),date:i(D).toISOString(),startTime:i(S),endTime:i(C)},{error:z}=await de.db.bookings.add({...x});if(h(P,""),z){if(De(z)){h(P,f(z.issues[0].message));return}h(P,f(z.message));return}ke("successful-booking-popup")}ne(()=>{document.addEventListener("dialog-close",t=>{t.detail.id==="successful-booking-popup"&&location.reload()})});var I=Xe(),E=n(I),O=n(E);Qe(O,{get name(){return i(s)},set name(t){h(s,f(t))},get email(){return i(v)},set email(t){h(v,f(t))},get phone(){return i(c)},set phone(t){h(c,f(t))}});var F=d(O,2);Re(F,{get selectedManicurist(){return i(u)},set selectedManicurist(t){h(u,f(t))},get selectedPayingState(){return i(g)},set selectedPayingState(t){h(g,f(t))},get selectedServices(){return i(m)},set selectedServices(t){h(m,f(t))},get selectedExtras(){return i(p)},set selectedExtras(t){h(p,f(t))},get totalPrice(){return i(_)},set totalPrice(t){h(_,f(t))},get advanceAmount(){return i(b)},set advanceAmount(t){h(b,f(t))},get manicuristsOptions(){return e.manicuristsOptions},servicesOptions:r,extrasOptions:o});var R=d(F,2);Ge(R,{get date(){return i(D)},set date(t){h(D,f(t))},get startTime(){return i(S)},set startTime(t){h(S,f(t))},get endTime(){return i(C)},set endTime(t){h(C,f(t))}});var k=d(R,2);ee(k,()=>i(P)!=="",t=>{var x=We(),z=n(x);l(x),j(()=>A(z,`Ha ocurrido un error: ${i(P)??""}`)),q(t,x)}),oe(2),l(E),l(I),xe("submit",E,H),q(a,I),Z()}export{st as default};
