import"./Dialog.astro_astro_type_script_index_0_lang.C-5Vl6lh.js";import{o as m,c as b}from"./utils.oMC_d_GW.js";import{u as p}from"./filter.Dk79kzbe.js";import{a as f,i as h}from"./_astro_actions.B-cTUEzu.js";import"./CloseMenuButton.astro_astro_type_script_index_0_lang.nee8CeAz.js";const E=document.getElementById("add-service-btn"),v=document.getElementById("search-service-btn"),l=document.getElementById("search-input");try{if(!E)throw new Error("Add service button not found");if(!(v instanceof HTMLButtonElement))throw new Error("Search service button not found");if(!(l instanceof HTMLInputElement))throw new Error("Search input not found");E.addEventListener("click",()=>{m("addService")});const n=()=>{const t=new URL(window.location.href),e=p(t,{search:l.value.trim(),page:"1"});window.location.href=e};v.addEventListener("click",n),l.addEventListener("keydown",t=>{t.key==="Enter"&&n()})}catch(n){console.error("Error: ",n)}class S extends HTMLElement{connectedCallback(){const t=this.querySelector("form"),e=document.getElementById("error-content"),r=this.querySelector(".submit-button"),c=document.getElementById("add-durationHours");if(!t)throw new Error("Form not found");if(!e)throw new Error("Error content not found");if(!(c instanceof HTMLInputElement))throw new Error("Duration hours not found");if(!(r instanceof HTMLButtonElement))throw new Error("Submit button not found");const i=o=>{const[s,u]=o.split(":");return!s||!u?(e.innerText="Las horas de duración tienen que tener un formato de HH:MM",!1):(e.innerText="",!0)};c.addEventListener("blur",o=>{if(!(o.target instanceof HTMLInputElement))return;const s=o.target.value;if(!i(s))return;const[u,a]=s.split(":"),d=u.padStart(2,"0"),w=a.padStart(2,"0");o.target.value=`${d}:${w}`}),t.addEventListener("submit",async o=>{o.preventDefault();const s=new FormData(t);if(!i(c.value))return;r.disabled=!0;const{error:u}=await f.db.services.addService(s);if(r.disabled=!1,!u){location.reload();return}if(u){if(h(u)){e.innerText=u.issues[0].message;return}e.innerText=u.message;return}})}}customElements.define("service-add-form",S);try{const n=document.getElementById("edit-service-form"),t=document.getElementById("s-error-content"),e=document.getElementById("edit-durationHours"),r=document.getElementById("s-edit-submit-btn");if(!(n instanceof HTMLFormElement))throw new Error("Form not found");if(!t)throw new Error("Error content not found");if(!(e instanceof HTMLInputElement))throw new Error("Duration hours not found");if(!(r instanceof HTMLButtonElement))throw new Error("Submit button not found");const c=i=>{const[o,s]=i.split(":");return!o||!s?(t.innerText="Las horas de duración tienen que tener un formato de HH:MM",!1):(t.innerText="",!0)};e.addEventListener("blur",i=>{if(!(i.target instanceof HTMLInputElement))return;const o=i.target.value;if(!c(o))return;const[s,u]=o.split(":"),a=s.padStart(2,"0"),d=u.padStart(2,"0");i.target.value=`${a}:${d}`}),n.addEventListener("submit",async i=>{i.preventDefault();const o=new FormData(n);if(!c(e.value))return;r.disabled=!0;const{error:s}=await f.db.services.editService(o);if(r.disabled=!1,!s){location.reload();return}if(s){if(h(s)){t.innerText=s.issues[0].message;return}t.innerText=s.message;return}})}catch(n){console.error("Error:",n)}try{const n=document.getElementById("delete-service-form"),t=document.getElementById("s-delete-submit-btn"),e=document.querySelector("button.cancel"),r=document.getElementById("s-delete-error-content");if(!e||!(t instanceof HTMLButtonElement))throw"Button not found";if(!(n instanceof HTMLFormElement))throw"Form not found";if(!r)throw"Error content not found";n.addEventListener("submit",async c=>{c.preventDefault();const i=new FormData(n);t.disabled=!0;const{error:o}=await f.db.services.deleteService(i);if(t.disabled=!1,!o){location.reload();return}r.innerText=o.message}),e.addEventListener("click",()=>b("deleteService"))}catch(n){console.error("Error:",n)}function g(n){if(n<0)return"00:00";const t=Math.floor(n),e=Math.round((n-t)*60);return`${t.toString().padStart(2,"0")}:${e.toString().padStart(2,"0")}`}class y extends HTMLElement{connectedCallback(){const t=this.querySelector("button"),e=document.getElementById("edit-service-form");if(!t)throw"Button not found";if(!(e instanceof HTMLFormElement))throw new Error("Form not found");const r=JSON.parse(this.dataset.service||"{}");t.addEventListener("click",async()=>{e.serviceId.value=r.id,e.nameService.value=r.name,e.price.value=r.price,e.description.value=r.description,e.durationHours.value=g(r.durationHours),e.category.value=r.category,m("editService")})}}customElements.define("service-edit-button",y);class B extends HTMLElement{connectedCallback(){const t=this.querySelector("button"),e=document.getElementById("delete-service-form"),r=document.getElementById("error-content"),c=document.getElementById("selected-service");if(!t)throw"Button not found";if(!(e instanceof HTMLFormElement))throw"Form not found";if(!c)throw"Selected service element not found";if(!r)throw"Error content not found";t.addEventListener("click",()=>{const{id:i,name:o}=JSON.parse(this.dataset.service||"{}");e.serviceId.value=i,c.innerHTML=o,r.innerText="",m("deleteService")})}}customElements.define("service-delete-button",B);
